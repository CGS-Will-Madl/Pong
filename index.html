<!DOCTYPE html>
<html>
	<head>
		<title>4 Player Pong</title>
		<link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
		<link href="pongIcon.png" rel="shortcut icon">
		<style>
			html, body {
				height: 100%;
				margin: 0;
			}
			body {
				background: darkgrey;
				font-family: 'Press Start 2P', sans-serif;
				text-align: center;
			}
			canvas {
				background: black;
				border: 1px dashed white;
				margin: auto;
				display: block;
			}
			h1 {
				text-decoration: underline;
			}
		</style>
	</head>
	<body>
		<h1>FOUR PLAYER PONG</h1>
		<h2>How to play:</h2>
		<p>Player1 (Blue): "q" to go up, "a" to go down.</p>
		<p>Player2 (Green): "[" to go left, "]" to go right.</p>
		<p>Player3 (Red): "'" to go up, "/" to go down.</p>
		<p>Player4 (Yellow): "z" to go left, "x" to go right.</p>
		<p>You have 10 lives. When you run out of lives you can no longer move your paddle. The person that is still alive when the other three players are dead is the winner.</p>
		<h2>Press any key to start!</h2>
		<br>
		<canvas width="800" height="600" id="game"></canvas>
		<br>
		<br>
		<br>
		<br>
		<br>
		<p>&#169; Will Madl - 2018</p>
		<br>
		<script>
			
			// A canvas is used to draw graphics (using a 2d context)
			var canvas = document.getElementById('game');
			var context = canvas.getContext('2d');
			
			// The size of the player (width and height)
			var gridSize = 16;
			
			var start = false;
			
			var scoreRed = 0;
			var scoreGreen = 0;
			var scoreYellow = 0;
			var scoreBlue = 0;


			// Use an object prototype instead of manually creating an object
			// Use the parameter of colour so that we can identify different players
			function playerPrototype(playerColour) {
				this.x = 400-gridSize/2;
				this.y = 300-gridSize/2;
				this.speedX = 0;
				this.speedY = 0;

				// Combine move and draw into one function called update
				this.update = function() {
					
					// Move the player
					this.x = this.x + this.speedX;
					this.y = this.y + this.speedY;
					
					// Then draw the player
					context.fillStyle = playerColour;
					context.fillRect(this.x, this.y, gridSize-1, gridSize-(-100));
					
				};
			}
			
			function playerPrototype2(playerColour2) {
				this.x = 400-gridSize/2;
				this.y = 300-gridSize/2;
				this.speedX = 0;
				this.speedY = 0;

				// Combine move and draw into one function called update
				this.update = function() {
					
					// Move the player
					this.x = this.x + this.speedX;
					this.y = this.y + this.speedY;
					
					// Then draw the player
					context.fillStyle = playerColour2;
					context.fillRect(this.x, this.y, gridSize-(-100), gridSize-1);
					
				};
			}
			
			function ball(ballColour) {
				this.x = 400-gridSize/2;
				this.y = 300-gridSize/2;
				this.speedX = 0;
				this.speedY = 0;

				// Combine move and draw into one function called update
				this.update = function() {
					
					// Move the ball
					this.x = this.x + this.speedX;
					this.y = this.y + this.speedY;
					
					// Then draw the ball
					context.fillStyle = ballColour;
					context.fillRect(this.x, this.y, gridSize-1, gridSize-1);
					
				};
			}
			
			// Set the colour of player to lime, and use the prototype
			var player = new playerPrototype('blue');
			
			// Add a second player using the same prototype, with a different colour
			var player2 = new playerPrototype('red');
			
			// Add a second player using the same prototype, with a different colour
			var player3 = new playerPrototype2('green');
			
			// Add a second player using the same prototype, with a different colour
			var player4 = new playerPrototype2('yellow');
			
			var ball = new ball('white');
			
			// Game loop
			function loop() {
				
				if (player.x != 20){
					player.x = 20;
				}
				
				if (player2.x != 761){
					player2.x = 761;	
				}
				
				if (player3.y != 20){
					player3.y = 20;
				}
				
				if (player4.y != 561){
					player4.y = 561;	
				}
				
				if (player.x >= 761){
                    player.speedX = -6;
				} if (player.x <= 20){
                    player.speedX = 6;
				} if (player.y >= 561){
               	 	player.speedY = -6;
				} if (player.y <= 20){
                	player.speedY = 6;
        		} 
				
				if (player2.x >= 761){
                    player2.speedX = -6;
				} if (player2.x <= 20){
                    player2.speedX = 6;
				} if (player2.y >= 561){
                	player2.speedY = -6;
				} if (player2.y <= 20){
                	player2.speedY = 6;
        		} 
				
				if (player3.x >= 761){
                    player3.speedX = -7;
				} if (player3.x <= 20){
                    player3.speedX = 7;
				} if (player3.y >= 561){
                	player3.speedY = -7;
				} if (player3.y <= 20){
                	player3.speedY = 7;
        		} 
				
				if (player4.x >= 761){
                    player4.speedX = -7;
				} if (player4.x <= 20){
                    player4.speedX = 7;
				} if (player4.y >= 561){
                	player4.speedY = -7;
				} if (player4.y <= 20){
                	player4.speedY = 7;
        		} 
				
				if (ball.x >= 761){
                    ball.speedX = -5;
					scoreRed ++;
				} if (ball.x <= 20){
                    ball.speedX = 5;
					scoreBlue++;
				} if (ball.y >= 561){
                	ball.speedY = -5;
					scoreYellow ++;
				} if (ball.y <= 20){
                	ball.speedY = 5;
					scoreGreen ++;
        		} 
				
				/*if (ball.x < 50 && (player.y + 100) == ball.y) {
					alert('hi');
				}
				
				if (ball.y > player.y && ball.y > player.y +100){
					alert("xdfg")
				}*/
				
				if (ball.x < 20) {
					if (ball.y > player.y && ball.y < player.y+100){
						scoreBlue --;
					}
				}
				
				if (ball.x > 761) {
					if (ball.y > player2.y && ball.y < player2.y+100){
						scoreRed --;
					}
				}
				
				if (ball.y < 20) {
					if (ball.x > player3.x && ball.x < player3.x+100){
						scoreGreen --;
					}
				}
				
				if (ball.y > 561) {
					if (ball.x > player4.x && ball.x < player4.x+100){
						scoreYellow --;
					}
				}
				
				// Clear the context so objects can be redrawn
				context.clearRect(0,0,canvas.width,canvas.height);

				// Move and draw each player using their in-built update() functions
				player.update();
				player2.update();
				player3.update();
				player4.update();
				ball.update();

				// Call the next frame
				requestAnimationFrame(loop);
			}

			// Event listeners enable the players to interact, with events such as mouse clicks or keys being pressed 
			document.addEventListener('keydown', function(e) {
				
				// Player 1 - WASD Keys
				if (e.key == "a") {
					player.speedY = 6;
					player.speedX = 0;
				} else if (e.key == "q") {
					player.speedY = -6;
					player.speedX = 0;
				} else if (e.key == "Alt") {
					player.speedX = 0;
					player.speedY = 0;
				}
				
				//Player - IJKL Keys
				if (e.key == "/") {
					player2.speedY = 6;
					player2.speedX = 0;
				} else if (e.key == "'") {
					player2.speedY = -6;
					player2.speedX = 0;
				} else if (e.key == "Alt") {
					player2.speedX = 0;
					player2.speedY = 0;
				}
				
				// Player 3 - Arrow Keys | Players 3 and 4 are slightly faster to make up for the rectangular playing field to make the game fair. I noticed too late on to change.
				if (e.key == "[") {
					player3.speedX = -7;
					player3.speedY = 0;
				} else if (e.key == "]") {
					player3.speedX = 7;
					player3.speedY = 0;
				}  else if (e.key == "Alt") {
					player3.speedX = 0;
					player3.speedY = 0;
				}
				
				// Player 4 - TFGH Keys
				if (e.key == "z") {
					player4.speedX = -7;
					player4.speedY = 0;
				} else if (e.key == "x") {
					player4.speedX = 7;
					player4.speedY = 0;
				}  else if (e.key == "Alt") {
					player4.speedX = 0;
					player4.speedY = 0;
				}
				
				if (e.key !== "q" && e.key !== "a" && e.key !== "[" && e.key !== "]" && e.key !== "ArrowUp" && e.key !== "ArrowDown" && e.key !== "z" && e.key !== "x" && e.key !== "w" && e.key !== "s" && e.key !== "1" && e.key !== "2" && e.key !== "Alt" && e.key !== "Shift" && e.key !== "ArrowLeft" && e.key !== "Delete" && e.key !== "=" && e.key !== "-" && e.key !== "p" && e.key !== "'" && e.key !== ";" && e.key !== "c" && e.key !== "Tab" && e.key !== "." && e.key !== "/" && e.key !== "Enter" && e.key !== "r") {
				ball.speedX = 4;
				ball.speedY = 3;
				start = true;
				}
				
				if (scoreRed >= 10) {
					player2.speedY = 0;
				}
				
				if (scoreBlue >= 10) {
					player.speedY = 0;
				}
				
				if (scoreYellow >= 10) {
					player4.speedX = 0;
				}
				
				if (scoreGreen >= 10) {
					player3.speedX = 0;
				}
				
			});
			
			// Start the game by calling the first frame
			requestAnimationFrame(loop);
		</script>
	</body>
</html>
